---
title: Production readineess checklist
id: TN0008
tags: [server, sre, client, best practices]
---

Before you start to take on production traffic from your clients, we'd recommend running through this checklist.

## In Apollo Studio

- Ensure you are creating [graph variants](/studio/org/graphs#managing-variants) to differentiate your development stages
  - Optionally, [protect your production variant](/studio/org/graphs#protected-variants-enterprise-only) to avoid accidental changes while working in Apollo Studio
- Ensure your [clients are being correctly identified](/studio/client-awareness/) by name and version
  - If using an Apollo Client library, add the name and version to the constructor 
    - For example, the [React client uses the `name` and `version` attributes](/react/api/core/ApolloClient#name)in the constructor options
  - If using a third-party GraphQL client, set the `apollographql-client-name` and `apollographql-client-version` headers on the request to identify your client
  
## Server-side
- Turn off introspection for your production servers
  - Apollo Studio can be used to see the schema per variant if required
- Ensure [Managed Federation](/federation/managed-federation/setup/) is configured
- Ensure [`rover subgraph check`](/rover/commands/subgraphs#subgraph-check) and [`rover subgraph publish`](/rover/commands/subgraphs#subgraph-publish) are integrated into your CI/CD pipeline
- If your [subgraph server is listed as compatible with `ftv1`](/federation/other-servers), ensure [federated traces](/federation/metrics/) are enabled and are being visualized as expected within Apollo Studio
  - Enable [fractional trace sampling via `fieldLevelInstrumentation`](/studio/metrics/field-usage/#fractional-sampling) to reduce performance hits due to tracing
- Consider adding caching layers
  - Apollo Server and Apollo Router have support for [Automatic Persisted Queries (APQ)](/apollo-server/performance/apq/) out of the box
    - If using an Apollo Client, make sure to enable APQ support
    - If using Apollo Server, ensure you use a [distributed caching system](/apollo-server/performance/cache-backends) for APQ in production to avoid cache inconsistency across server instances
    - Additionally, you can have your Apollo Gateway send APQ requests
      - See [the example below](#apollo-gateway-apq-example) for an example of how to configure this
  - [Full response caching](/apollo-server/performance/caching/) can be introduced to enable CDN caching abilities
- Ensure you've load tested your graph
  - This should be done with a load representative of your current traffic. Operations that will be used in production can be used in the load testing
  - To investigate performance issues, identify which operations are performing slowly using Apollo Studio
    - Look at the resolver execution times for slow areas of execution 
    - Avoid having multiple datasource calls in a single resolver whenever possible
    - Understand [query plan execution](/federation/query-plans) for slow performing operations and to help optimize schema design


### Apollo Gateway APQ example

This example uses both the [`buildService`](/federation/api/apollo-gateway/#buildservice) option and the [`RemoteGraphQLDataSource`](/federation/api/apollo-gateway/#apq) class to enable APQ to each subgrpah.

```js
const { ApolloServer } = require('apollo-server');
const { ApolloGateway, RemoteGraphQLDataSource } = require('@apollo/gateway');
const { readFileSync } = require('fs');

const gateway = new ApolloGateway({
  supergraphSdl: readFileSync("./supergraph.graphql").toString(),
  buildService: ({url})=>{
    return new RemoteGraphQLDataSource({url, apq:false})
  }
});

const server = new ApolloServer({
  gateway,
});

server.listen().then(({ url }) => {
  console.log(`ğŸš€ Server ready at ${url}`);
});
```